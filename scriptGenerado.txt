/* ---------------------------------------------------- */
/*  Generated by Enterprise Architect Version 13.5 		*/
/*  Created On : 14-oct.-2023 18:30:06 				*/
/*  DBMS       : MySql 						*/
/* ---------------------------------------------------- */

SET FOREIGN_KEY_CHECKS=0 
;

/* Drop Tables */

DROP TABLE IF EXISTS `Categoria` CASCADE
;

DROP TABLE IF EXISTS `Detalleventa` CASCADE
;

DROP TABLE IF EXISTS `Inventario` CASCADE
;

DROP TABLE IF EXISTS `Notaventa` CASCADE
;

DROP TABLE IF EXISTS `Producto` CASCADE
;

DROP TABLE IF EXISTS `Usuario` CASCADE
;

ALTER TABLE `users` 
 ADD rol TEXT NULL
;

/* Create Tables */

CREATE TABLE `categoria`
(
    `id` INT NOT NULL AUTO_INCREMENT, -- Cambiado a autoincrementable
    `nombre` VARCHAR(50) NULL,
    PRIMARY KEY (`id`) -- Definido como clave primaria
);

CREATE TABLE `detalleventa`
(
    `id` INT NOT NULL AUTO_INCREMENT, -- Cambiado a autoincrementable
    `cantidad` INT NULL,
    `idNotaventa` INT NULL,
    `idProducto` INT NULL,
    PRIMARY KEY (`id`) -- Definido como clave primaria
);

CREATE TABLE `inventario`
(
    `id` INT NOT NULL AUTO_INCREMENT, -- Cambiado a autoincrementable
    `accion` VARCHAR(50) NULL,
    `cantidad` INT NULL,
    `idUsuario` BIGINT UNSIGNED NOT NULL,
    `idProducto` INT NOT NULL,
    PRIMARY KEY (`id`) -- Definido como clave primaria
);

CREATE TABLE `notaventa`
(
    `id` INT NOT NULL AUTO_INCREMENT, -- Cambiado a autoincrementable
    `fecha` DATE NULL,
    `montototal` DOUBLE(10,2) NULL,
    `idUsuario` BIGINT UNSIGNED NOT NULL,
    PRIMARY KEY (`id`) -- Definido como clave primaria
);

CREATE TABLE `producto`
(
    `id` INT NOT NULL AUTO_INCREMENT, -- Cambiado a autoincrementable
    `nombre` VARCHAR(50) NULL,
    `precio` DOUBLE(10,2) NULL,
    `stock` INT NULL,
    `url` TEXT NULL,		
    `idCategoria` INT NULL,
    PRIMARY KEY (`id`) -- Definido como clave primaria
);

/*CREATE TABLE `Usuario`
(
    `id` INT NOT NULL AUTO_INCREMENT, -- Cambiado a autoincrementable
    `Correo` VARCHAR(50) NULL,
    `Nombre` VARCHAR(50) NULL,
    `Password` VARCHAR(50) NULL,
    `Rol` INT NULL,
    PRIMARY KEY (`id`) -- Definido como clave primaria
);*/

/* Create Foreign Key Constraints */

ALTER TABLE `detalleventa` 
 ADD CONSTRAINT `FK_DetalleVenta_Producto`
	FOREIGN KEY (`idProducto`) REFERENCES `producto` (`id`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `detalleventa` 
 ADD CONSTRAINT `FK_DetalleVenta_NotaVenta`
	FOREIGN KEY (`idNotaventa`) REFERENCES `notaventa` (`id`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `inventario` 
 ADD CONSTRAINT `FK_Inventario_Producto`
	FOREIGN KEY (`idProducto`) REFERENCES `producto` (`id`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `inventario` 
 ADD CONSTRAINT `FK_Inventario_users`
	FOREIGN KEY (`idUsuario`) REFERENCES `users` (`id`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `notaventa` 
 ADD CONSTRAINT `FK_Notaventa_users`
	FOREIGN KEY (`idUsuario`) REFERENCES `users` (`id`) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE `producto` 
 ADD CONSTRAINT `FK_Producto_Categoria`
	FOREIGN KEY (`idCategoria`) REFERENCES `categoria` (`id`) ON DELETE No Action ON UPDATE No Action
;

SET FOREIGN_KEY_CHECKS=1 
;
